# LLM Integration API

Machine-readable documentation API designed for AI agents and LLM-powered tools.

## Overview

The Strata Documentation API provides JSON endpoints for LLMs to efficiently discover and access documentation content. The API serves the **actual MDX documentation content** in JSON format - not manually maintained summaries.

**Key advantage:** Single source of truth. The JSON API is auto-generated from the same MDX files humans read, so it's always in sync.

## How It Works

```
1. LLM hits /api/docs.json (root index)
2. Gets overview + links to sections
3. Picks relevant section (e.g., /api/semantic-model.json)
4. Receives full markdown content from all pages in that section
5. Can navigate to specific pages as needed
```

This is **context-efficient** — LLMs fetch only the sections they need.

## API Endpoints

### Root Index

```
GET /api/docs.json
```

Returns documentation structure with critical rules and links to all sections.

**Response includes:**
- `title`, `version`, `summary`
- `critical_rules` — Key constraints (unique naming, no many-to-many, etc.)
- `sections` — Array of documentation sections with summaries and endpoints
- `full_markdown` — Link to `/llms.txt` for complete docs in one file

### Section Endpoints

Each section returns all pages in that section with full markdown content:

```
GET /api/getting-started.json    # Installation, concepts, tutorial
GET /api/cli.json                # All CLI command docs
GET /api/semantic-model.json     # Tables, fields, relationships
GET /api/advanced.json           # Universe formation, routing, etc.
GET /api/examples.json           # Patterns and recipes
GET /api/troubleshooting.json   # Common issues and solutions
```

**Each section response includes:**

```json
{
  "id": "semantic-model",
  "title": "Semantic Model",
  "url": "/developer-docs/semantic-model",
  "summary": "Tables, fields, relationships, expressions",
  "pages": [
    {
      "id": "tables",
      "title": "Tables",
      "url": "/developer-docs/semantic-model/tables",
      "path": "semantic-model/tables.mdx",
      "content_markdown": "# Tables\n\nDefine semantic metadata...\n\n[full MDX content]",
      "frontmatter": {},
      "sections": [
        {"level": 1, "text": "Tables"},
        {"level": 2, "text": "Overview"},
        {"level": 2, "text": "Required Fields"}
      ]
    }
  ],
  "relatedLinks": [...]
}
```

**Key fields:**
- `content_markdown` — Full MDX content from the page (includes examples, warnings, code blocks)
- `sections` — Heading structure for navigation within the page
- `frontmatter` — Metadata from MDX file
- `relatedLinks` — Cross-references to other pages

### JSON Schema Endpoints

Validate YAML files programmatically:

```
GET /api/schema/table.json      # Table YAML schema (tbl.*.yml)
GET /api/schema/relation.json   # Relation YAML schema (rel.*.yml)
GET /api/schema/project.json    # Project YAML schema (project.yml)
```

**Use for:**
- Validating generated YAML before deployment
- Understanding required vs optional fields
- Seeing allowed enum values (cardinality types, data types, etc.)

### CLI Commands Reference

```
GET /api/cli/commands.json
```

Returns all CLI commands with syntax and options. Useful for LLMs helping users with command-line operations.

## LLM Navigation Patterns

### Pattern 1: Targeted Lookup

```
User: "How do I define a compound measure?"

LLM:
1. GET /api/docs.json → sees "semantic-model" section
2. GET /api/semantic-model.json → finds "compound.mdx" page
3. Reads content_markdown for compound measures
4. Returns answer with examples from docs
```

### Pattern 2: Broad Context

```
User: "Help me build a semantic model"

LLM:
1. GET /llms.txt → loads full documentation
2. Has complete context for entire conversation
```

### Pattern 3: YAML Generation

```
User: "Create a table for orders"

LLM:
1. GET /api/schema/table.json → understands structure
2. GET /api/semantic-model.json → finds tables page for examples
3. Generates YAML following schema + examples
4. Validates against schema
```

## Response Structure

All section endpoints follow this structure:

```typescript
{
  id: string;              // Section identifier
  title: string;           // Human-readable title
  url: string;             // Web URL for this section
  summary: string;         // Brief description
  pages: Array<{
    id: string;            // Page identifier
    title: string;         // Page title
    url: string;           // Web URL
    path: string;          // File path (e.g., "semantic-model/tables.mdx")
    content_markdown: string;  // Full MDX content
    frontmatter: object;   // Metadata from MDX
    sections: Array<{      // Heading structure
      level: number;       // 1-6 (h1-h6)
      text: string;        // Heading text
    }>;
  }>;
  relatedLinks: Array<{
    title: string;
    url: string;
  }>;
}
```

## Best Practices for LLM Integration

1. **Start with /api/docs.json** — Understand available sections and critical rules
2. **Use section endpoints** — Fetch only relevant sections (semantic-model, cli, etc.)
3. **Parse content_markdown** — Contains full documentation with examples
4. **Check sections array** — Navigate to specific headings within pages
5. **Validate with schemas** — Use `/api/schema/*.json` to validate generated YAML
6. **Cache responses** — Documentation doesn't change frequently

## Markdown Export

For full documentation in a single file:

```
GET /llms.txt
```

Returns complete documentation index in markdown format. Best for:
- Initial context loading
- LLMs with large context windows (100K+ tokens)
- When you need everything upfront

## MCP Server Integration

For tool-based LLM access (Claude, ChatGPT with tools):

```json
{
  "mcpServers": {
    "strata-docs": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-fetch"],
      "env": {
        "STRATA_DOCS_API": "https://developers.strata.site/api"
      }
    }
  }
}
```

This allows LLMs to use tools like:
- `fetch_docs(section)` — Get documentation section
- `fetch_schema(type)` — Get YAML schema
- `search_docs(query)` — Find relevant pages

## Next Steps

- [JSON Schema Reference](/api/json-schema) — Schema definitions
- [CLI Commands](/cli) — Full command reference
- [Semantic Model](/semantic-model) — Model documentation
