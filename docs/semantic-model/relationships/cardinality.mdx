# Cardinality

Understand relationship cardinality types.

:::danger Many-to-Many Not Supported
Strata does not support `many_to_many` relationships. Use junction/bridge tables with two separate relationships (`one_to_many` and `many_to_one`) instead.
:::

## Overview

Cardinality defines the relationship type between two tables. It tells the planner how rows in one table relate to rows in another.

## Cardinality Types

### many_to_one

Most common type. Many rows in left table match one row in right table.

**Example:** Many orders belong to one customer

```yaml
orders_customer:
  left: Orders
  right: Customer
  sql: left.customer_id = right.id
  cardinality: many_to_one
```

**Use cases:**
- Fact table to dimension table
- Child to parent relationships
- Foreign key relationships

### one_to_many

One row in left table matches many rows in right table.

**Example:** One customer has many orders

```yaml
customer_orders:
  left: Customer
  right: Orders
  sql: left.id = right.customer_id
  cardinality: one_to_many
```

**Use cases:**
- Parent to child relationships
- One-to-many associations
- Reverse of many_to_one

### one_to_one

One row in left table matches one row in right table.

**Example:** One user has one profile

```yaml
user_profile:
  left: User
  right: User Profile
  sql: left.id = right.user_id
  cardinality: one_to_one
```

**Use cases:**
- User profiles
- Settings tables
- Extension tables

## many_to_many Not Supported

⚠️ Strata does not support `many_to_many` relationships.

**Workaround:** Create a junction/bridge table and use two relationships:

```yaml
# Instead of many_to_many:
# Users <-> Roles

# Create:
# Users -> UserRoles -> Roles

users_user_roles:
  left: Users
  right: User Roles
  sql: left.id = right.user_id
  cardinality: one_to_many

user_roles_roles:
  left: User Roles
  right: Roles
  sql: left.role_id = right.id
  cardinality: many_to_one
```

## Choosing Cardinality

### Fact to Dimension (many_to_one)

```yaml
sales_customer:
  left: Sales          # Fact table (many rows)
  right: Customer      # Dimension table (one row per customer)
  sql: left.customer_id = right.id
  cardinality: many_to_one
```

### Dimension to Dimension (one_to_one)

```yaml
customer_address:
  left: Customer       # One customer
  right: Address       # One address per customer
  sql: left.address_id = right.id
  cardinality: one_to_one
```

### Parent to Child (one_to_many)

```yaml
customer_orders:
  left: Customer       # One customer
  right: Orders         # Many orders per customer
  sql: left.id = right.customer_id
  cardinality: one_to_many
```

## Best Practices

1. **Use many_to_one** for fact-to-dimension relationships
2. **Match database relationships** - Cardinality should reflect actual data
3. **Avoid many_to_many** - Use junction tables instead
4. **Document relationships** - Add comments explaining relationships

## Next Steps

- [Join types](/docs/semantic-model/relationships/join-types)
- [Relationships guide](/docs/cli/relationships)
